from src.wind import get_wind_prediction

import numpy as np


def test_get_wind_prediction(timeseries):
    expected_wind_speed = np.array(
        [
            9.559817053919174,
            10.470987116870845,
            11.382157179822517,
            11.636089820317245,
            11.890022460811974,
            12.039394602279462,
            12.188766743746948,
            12.15889231545345,
            12.129017887159952,
            12.63688316814941,
            13.144748449138865,
            12.816129737910392,
            12.48751102668192,
            12.592071525709162,
            12.696632024736402,
            13.204497305725859,
            13.712362586715315,
            14.832653647721468,
            15.952944708727621,
            16.401061133130085,
            16.849177557532542,
            17.401854480962246,
            17.954531404391947,
            19.05988525125135,
            20.165239098110757,
            20.239925168844504,
            20.314611239578245,
            20.792602092274205,
            21.27059294497016,
            21.47971394302464,
            21.688834941079126,
            20.224987954697752,
            18.76114096831638,
            17.461603337549242,
            16.162065706782105,
            15.624325997499152,
            15.086586288216196,
            15.594451569205653,
            16.10231685019511,
            16.460809989717077,
            16.819303129239046,
            16.610182131184565,
            16.401061133130085,
            15.624325997499152,
            14.847590861868216,
            14.414411651612502,
            13.981232441356791,
            13.607802087688073,
        ]
    )
    expected_wind_power = np.array(
        [
            291.1990119042773,
            318.2467334982125,
            337.09640893559697,
            341.1801897476063,
            345.18768818004787,
            347.4510447305678,
            349.420052287742,
            349.0370115517676,
            348.6539708157931,
            355.4529447646642,
            360.8984693500503,
            357.6553340391293,
            353.5001502550117,
            354.87530194096496,
            356.1989478745196,
            361.21222119507934,
            364.2118029414701,
            365.92435798572785,
            358.97326742612927,
            355.419066472543,
            351.8648655189568,
            347.48135100953374,
            343.0622247508258,
            333.57334408512827,
            324.0844634194308,
            323.4433228339106,
            322.8021822483906,
            318.6988825010619,
            314.5955827537333,
            312.800389114277,
            311.00519547482065,
            323.5715509510147,
            336.13790642720875,
            347.0074575490556,
            357.3146403144557,
            361.4721289704478,
            365.0605403226235,
            361.67484160549196,
            357.78853377493385,
            354.94517301206486,
            352.10181224919586,
            353.76043936086944,
            355.419066472543,
            361.4721289704478,
            365.9316439230674,
            366.12009402389737,
            365.4692430057775,
            363.5893380638325,
        ]
    )

    result = get_wind_prediction(timeseries)
    assert all(np.isclose(result.WindSpeed, expected_wind_speed))
    assert all(np.isclose(result.WindPower, expected_wind_power))

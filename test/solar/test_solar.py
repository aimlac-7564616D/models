from src.solar import get_solar_prediction

import numpy as np


def test_get_solar_prediction(timeseries):
    expected = np.array(
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.9468353566662153,
            44.44252231121898,
            115.4390507792946,
            173.68275251371597,
            213.89688559778978,
            232.4074969088157,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            234.50000000000006,
            230.2710814222738,
            213.1877775296418,
            182.222425769709,
            138.01882116378488,
            75.56888276466555,
            19.60579126322163,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
        ]
    )
    result = get_solar_prediction(timeseries)
    assert all(np.isclose(result["SolarPower"], expected))
